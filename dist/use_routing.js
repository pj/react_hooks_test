var e=require("react"),t=require("url"),r="[a-zA-Z_][a-zA-Z_0-9]*",a="(.*)";function n(e){for(var a=new t.URL(e,"http://hello"),n=[],o=new Map,i=new RegExp("^("+r+")=(string|number|boolean)$"),u=new RegExp("^("+r+")$"),l=0,f=a.pathname.split("/");l<f.length;l+=1){var s=f[l];if(""!==s){var h=s.match(i);if(h)n.push({name:h[1],type:h[2],_default:null});else{if(!(h=s.match(u)))throw new Error("Invalid path part "+s+" in route "+e);n.push({name:h[1],type:"path",_default:null})}}}for(var p=0,m=a.searchParams;p<m.length;p+=1){var c=m[p],v=c[0],w=c[1],d=w.match("(string|number|boolean)");if(d)o.set(v,{type:w,_default:null});else if(d=w.match("(\\d+.\\d+)"))o.set(v,{type:"number",_default:parseFloat(w)});else if(d=w.match("(\\d+)"))o.set(v,{type:"number",_default:parseInt(w)});else if(d=w.match("(true|false)"))o.set(v,{type:"boolean",_default:"true"===w});else{if(!(d=w.match("(.*)")))throw new Error("Invalid query parameter name: "+v+" value: "+w+" in route: "+e);o.set(v,{type:"string",_default:w})}}return{path:n,params:o}}function o(e,r){e=e.replace("#","");var n=new t.URL(e,"https://hello"),o=n.pathname.split("/");o=o.filter(function(e){return!e.match(/^\s*$/)});var i={};e:for(var u=0,l=r;u<l.length;u+=1){var f=l[u],s=f[0],h=f[1],p=h.path,m=h.params;if(i={},p.length===o.length){for(var c=0;c<p.length;c++){var v=p[c],w=o[c];if("path"===v._type&&v.name!==w)continue e;if("path"!==v._type){if("boolean"===v._type){if("true"===w||"false"===w){i[v.name]="true"===w;continue}continue e}if("number"===v._type){var d=parseInt(w);if(!isNaN(d)){i[v.name]=d;continue}var g=parseFloat(w);if(!isNaN(g)){i[v.name]=g;continue}continue e}if("string"===v._type){if(w.match(a)){i[v.name]=w;continue}continue e}throw new Error("Unable to identify path part "+w+" "+v)}}for(var y=0,_=m;y<_.length;y+=1){var b=_[y],E=b[0],N=b[1],x=n.searchParams.get(E);if(null===x&&N._default&&(i[E]=N._default),null!==x){if("boolean"===N._type){if("true"!==x&&"false"!==x)throw new Error("Invalid boolean for param: "+E+" boolean: "+x);i[E]="true"===x}if("number"===N._type){var R=parseInt(x),I=parseFloat(x);if(isNaN(R)){if(isNaN(I))throw new Error("Invalid number for param: "+E+" number "+x);i[E]=I}else i[E]=R}}}return{name:s,state:i}}}throw new Error("No valid route found for url: "+e)}function i(e,t,r){t=t||{};var a=r.get(e),n=[];if(a){for(var o=0,i=a.path;o<i.length;o+=1){var u=i[o];if("path"!==u._type){var l=t[u.name];if(!l)throw new Error("Path param "+u.name+" not found while generating url for "+e);n.push(l)}else n.push(u.name)}for(var f=[],s=0,h=a.params.entries();s<h.length;s+=1){var p=h[s],m=p[0],c=null;if(t[m]||(c=p[1]._default),!c)throw new Error("Query param "+m+" not found and no default while generating url for "+e);f.push(m+"="+c)}return f.length>0?"/"+n.join("/")+"?"+f.join("&"):"/"+n.join("/")}throw new Error("No route found for name "+e)}var u=e.createContext(null),l=new Map;exports.parseRoute=n,exports.matchRouteAndGenerateState=o,exports.formatUrl=i,exports.useRouter=function(t,r){var a=e.useState(null),f=a[0],s=a[1];Object.entries(r).forEach(function(e){l.set(e[0],n(e[1]))});var h=null;return f&&(h={back:function(){window.history.back()},forward:function(){window.history.forward()},navigate:function(e,t){var r=i(e,t,l);window.location.hash=r},name:f.name,state:f.state}),e.useEffect(function(){function e(e){e&&e.preventDefault();var t=o(window.location.hash,l);s(t)}return window.addEventListener("hashchange",e,!1),e(),function(){window.removeEventListener("hashchange",e,!1)}},[]),e.createElement(u.Provider,{value:h},t)},exports.useRouting=function(){return e.useContext(u)};
//# sourceMappingURL=use_routing.js.map
