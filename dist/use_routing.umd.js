!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("url")):"function"==typeof define&&define.amd?define(["exports","react","url"],t):t(e.useRouting={},e.react,e.url)}(this,function(e,t,n){var r="[a-zA-Z_][a-zA-Z_0-9]*",a="(.*)";function o(e){for(var t=new n.URL(e,"http://hello"),a=[],o=new Map,i=new RegExp("^("+r+")=(string|number|boolean)$"),u=new RegExp("^("+r+")$"),f=0,l=t.pathname.split("/");f<l.length;f+=1){var s=l[f];if(""!==s){var h=s.match(i);if(h)a.push({name:h[1],type:h[2],_default:null});else{if(!(h=s.match(u)))throw new Error("Invalid path part "+s+" in route "+e);a.push({name:h[1],type:"path",_default:null})}}}for(var p=0,c=t.searchParams;p<c.length;p+=1){var m=c[p],d=m[0],v=m[1],w=v.match("(string|number|boolean)");if(w)o.set(d,{type:v,_default:null});else if(w=v.match("(\\d+.\\d+)"))o.set(d,{type:"number",_default:parseFloat(v)});else if(w=v.match("(\\d+)"))o.set(d,{type:"number",_default:parseInt(v)});else if(w=v.match("(true|false)"))o.set(d,{type:"boolean",_default:"true"===v});else{if(!(w=v.match("(.*)")))throw new Error("Invalid query parameter name: "+d+" value: "+v+" in route: "+e);o.set(d,{type:"string",_default:v})}}return{path:a,params:o}}function i(e,t){e=e.replace("#","");var r=new n.URL(e,"https://hello"),o=r.pathname.split("/");o=o.filter(function(e){return!e.match(/^\s*$/)});var i={};e:for(var u=0,f=t;u<f.length;u+=1){var l=f[u],s=l[0],h=l[1],p=h.path,c=h.params;if(i={},p.length===o.length){for(var m=0;m<p.length;m++){var d=p[m],v=o[m];if("path"===d._type&&d.name!==v)continue e;if("path"!==d._type){if("boolean"===d._type){if("true"===v||"false"===v){i[d.name]="true"===v;continue}continue e}if("number"===d._type){var w=parseInt(v);if(!isNaN(w)){i[d.name]=w;continue}var g=parseFloat(v);if(!isNaN(g)){i[d.name]=g;continue}continue e}if("string"===d._type){if(v.match(a)){i[d.name]=v;continue}continue e}throw new Error("Unable to identify path part "+v+" "+d)}}for(var y=0,b=c;y<b.length;y+=1){var _=b[y],E=_[0],N=_[1],R=r.searchParams.get(E);if(null===R&&N._default&&(i[E]=N._default),null!==R){if("boolean"===N._type){if("true"!==R&&"false"!==R)throw new Error("Invalid boolean for param: "+E+" boolean: "+R);i[E]="true"===R}if("number"===N._type){var x=parseInt(R),I=parseFloat(R);if(isNaN(x)){if(isNaN(I))throw new Error("Invalid number for param: "+E+" number "+R);i[E]=I}else i[E]=x}}}return{name:s,state:i}}}throw new Error("No valid route found for url: "+e)}function u(e,t,n){t=t||{};var r=n.get(e),a=[];if(r){for(var o=0,i=r.path;o<i.length;o+=1){var u=i[o];if("path"!==u._type){var f=t[u.name];if(!f)throw new Error("Path param "+u.name+" not found while generating url for "+e);a.push(f)}else a.push(u.name)}for(var l=[],s=0,h=r.params.entries();s<h.length;s+=1){var p=h[s],c=p[0],m=null;if(t[c]||(m=p[1]._default),!m)throw new Error("Query param "+c+" not found and no default while generating url for "+e);l.push(c+"="+m)}return l.length>0?"/"+a.join("/")+"?"+l.join("&"):"/"+a.join("/")}throw new Error("No route found for name "+e)}var f=t.createContext(null),l=new Map;e.parseRoute=o,e.matchRouteAndGenerateState=i,e.formatUrl=u,e.useRouter=function(e,n){var r=t.useState(null),a=r[0],s=r[1];Object.entries(n).forEach(function(e){l.set(e[0],o(e[1]))});var h=null;return a&&(h={back:function(){window.history.back()},forward:function(){window.history.forward()},navigate:function(e,t){var n=u(e,t,l);window.location.hash=n},name:a.name,state:a.state}),t.useEffect(function(){function e(e){e&&e.preventDefault();var t=i(window.location.hash,l);s(t)}return window.addEventListener("hashchange",e,!1),e(),function(){window.removeEventListener("hashchange",e,!1)}},[]),t.createElement(f.Provider,{value:h},e)},e.useRouting=function(){return t.useContext(f)}});
//# sourceMappingURL=use_routing.umd.js.map
